function StateSave(){localStorage.state=JSON.stringify(STORAGE)}function LoadState(){try{STORAGE=JSON.parse(localStorage.state)}catch(e){}}function inherit(e,i){return this._inherits&&-1==this._inherits.indexOf(e)?(e.apply(this,i),void this._inherits.push(e)):0}function getSelf(e){return e._inherits=e._inherits||[],e.inherit=inherit,e}function BaseModel(){getSelf(this)}function Parking(){var e=getSelf(this);e.inherit(BaseModel),e.init=function(){e.priority_by_tag={},e.slot_by_type={}},e._getSlotByTag=function(i){var t=1/0,n=null;for(var a in e.slot_by_type){var r=e.slot_by_type[a],o=r.getPriorityFor(i);if(-1!=o){if(0==o)return r;(!n||t>o)&&(t=o,n=r)}}return n},e._getSlotByVehicle=function(i){for(var t=null,n=0;n<i.taglist.length;n++){var a=i.taglist[n];if(t=e._getSlotByTag(a))return t}return t},e.addSlots=function(i,t,n){e.slot_by_type[i]=new SlotSet({max:t,tagqueue:n})},e.register=function(i){var t=e._getSlotByVehicle(i);return t?(t.addVehicle(i),void console.log(t)):!1},e.clear=function(e){},e.clearAll=function(){},e.restoreState=function(){},e.saveState=function(){},e.yieldState=function(){},e.init()}function SlotSet(e){var i=getSelf(this);i.inherit(BaseModel),i.init=function(){i.has=0,i.max=e.max||0,i.tagqueue=e.tagqueue||[],i.vehicles=new Array(i.max)},i.addVehicle=function(e){if(i.has==i.max)return!1;for(var t=0;void 0!=i.vehicles[t];t++);i.vehicles[t]=e,i.has+=1},i.removeVehicle=function(e){},i.getPriorityFor=function(e){return i.has==i.max?-1:i.tagqueue.indexOf(e)},i.init()}function Tag(e){this.name=e,TAG[e]=this}function Vehicle(e){var i=getSelf(this);i.inherit(BaseModel),i.init=function(){i.taglist=e},i.copy=function(){return new Vehicle(e.slice())},i.init()}function declareInstances(){"Truck,Sedan,Disabled".split(",").map(function(e){new Tag(e)}),window.parking=new Parking,parking.addSlots("Trucks",10,[TAG.Truck,TAG.Disabled,TAG.Sedan]),parking.addSlots("Disabled",5,[TAG.Disabled]),parking.addSlots("Simple",15,[TAG.Sedan,TAG.Disabled]),window.dummy_Truck=new Vehicle([TAG.Truck]),window.dummy_Sedan=new Vehicle([TAG.Sedan]),window.dummy_Disabled=new Vehicle([TAG.Disabled])}function mainScenario(){parking.restoreState(),parking.yieldState(),parking.register(dummy_Sedan.copy()),parking.register(dummy_Sedan.copy()),parking.register(dummy_Disabled.copy()),parking.register(dummy_Truck.copy()),parking.yieldState()}window.STORAGE={},window.TAG={},declareInstances(),mainScenario();